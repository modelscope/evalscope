# æ¦œå•ä¸ç›²ä»ï¼šç”¨Â EvalScopeÂ æ‰“é€ ä½ çš„ä¸“å±åœºæ™¯è¯„æµ‹

å¤§å®¶ä¸€å®šéå¸¸ç†Ÿæ‚‰è¿™ä¸ªåœºæ™¯ï¼šæ¯å½“ä¸€ä¸ªæ–°çš„æ¨¡å‹å‘å¸ƒæ—¶ï¼Œæ€»ä¼šæœ‰ä¸€å¼ å¼ åä¸½çš„é›·è¾¾å›¾æˆ–æ¡å½¢å›¾æ¥å±•ç¤ºå…¶å¼ºå¤§çš„æ€§èƒ½ã€‚

![image.png](https://sail-moe.oss-cn-hangzhou.aliyuncs.com/yunlin/images/evalscope/doc/best_practice/bars.jpg)

è¿™äº›å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éƒ½èƒ½çœ‹åˆ°é‚£äº›è€³ç†Ÿèƒ½è¯¦çš„è¯„æµ‹åŸºå‡†åå­—ï¼š

*   MMLUï¼šæ¶µç›–å‡ åä¸ªå­¦ç§‘ï¼Œä»£è¡¨â€œé€šè¯†æ•™è‚²â€æ°´å¹³ï¼›
    
*   AIME25ï¼šæ•°å­¦ç«èµ›é¢˜ï¼Œä»£è¡¨â€œæ•°å­¦æ¨ç†â€èƒ½åŠ›ï¼›
    
*   LiveCodeBenchï¼šPythonÂ ä»£ç ç”Ÿæˆï¼Œä»£è¡¨â€œç¼–ç¨‹èƒ½åŠ›â€ã€‚
    

è¿™äº›æ¦œå•å°±åƒæ˜¯æ¨¡å‹çš„â€œé«˜è€ƒæˆç»©å•â€ï¼Œå®ƒä»¬å½“ç„¶é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ç¡®ç«‹äº†æ¨¡å‹åœ¨ä¸åŒé¢†åŸŸé‡Œçš„åŸºå‡†æ™ºåŠ›æ°´å¹³ï¼ˆSOTAï¼‰ã€‚ä½†é—®é¢˜åœ¨äºï¼Œèƒ½åœ¨ä¸åŒå­¦ç§‘è€ƒå‡ºé«˜åˆ†çš„æ¨¡å‹ï¼Œæ˜¯å¦å°±èƒ½èƒœä»»å®é™…çš„â€œå²—ä½å·¥ä½œâ€ï¼Ÿåœ¨æ¨¡å‹ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¾ˆå¤šäººéƒ½ä¼šé‡åˆ°è¿‡ç±»ä¼¼è¿™æ ·çš„å›°æƒ‘ï¼š

*   _â€œæ˜æ˜è¿™ä¸ªæ¨¡å‹åœ¨Â MMLUã€C-EvalÂ ä¸Šåˆ†æ•°å¾ˆé«˜ï¼Œä¸ºä»€ä¹ˆä¸€æ”¾åˆ°æˆ‘çš„Â RAGÂ åº”ç”¨é‡Œï¼Œå¹»è§‰æ»¡å¤©é£ï¼Ÿâ€_
    
*   _â€œæ¦œå•ç¬¬ä¸€çš„æ¨¡å‹ï¼Œå†™ä»£ç ç»å¸¸æ— æ³•è¿è¡Œï¼Œåè€Œæ˜¯é‚£ä¸ªæ¦œå•ç¬¬äº”çš„æ¨¡å‹æ›´æ‡‚æˆ‘çš„é¡¹ç›®ã€‚â€_
    

è¿™æ˜¯å› ä¸º**å…¬å¼€æ¦œå•è¡¡é‡çš„ï¼Œå¾€å¾€æ˜¯åœ¨ä¸åŒé¢†åŸŸä¸­ï¼Œç›¸å¯¹é€šç”¨çš„æ™ºåŠ›æ°´å¹³ã€‚è€Œæˆ‘ä»¬åœ¨æ¨¡å‹å®é™…ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œæ›´å…³æ³¨çš„æ˜¯å…·ä½“åœºæ™¯ä¸­çš„â€œä¸šåŠ¡ä»·å€¼â€ã€‚**æœ¬æ–‡é›†ä¸­ä»‹ç»å’Œè®¨è®ºäº†ï¼Œå¦‚ä½•åŸºäºEvalScopeçš„è‡ªå®šä¹‰è¯„æµ‹æŒ‡æ•°ï¼ˆEvaluationÂ Indexï¼‰ï¼Œæ¥æ„å»ºåœ¨ä¸åŒåœºæ™¯ä¸­ï¼Œèƒ½åæ˜ å’ŒåŒ¹é…â€œä¸šåŠ¡ä»·å€¼â€çš„è¯„æµ‹ã€‚

## 1.Â ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰è¯„æµ‹æŒ‡æ•°ï¼Ÿ

å¸¸è§çš„å¤§æ¨¡å‹è¯„æµ‹é›†ï¼ˆBenchmarkï¼‰å¾€å¾€è¦†ç›–çš„æ˜¯ç›¸å¯¹é€šç”¨çš„åœºæ™¯ã€‚è€Œåœ¨å…·ä½“çš„å‚ç›´é¢†åŸŸï¼Œå¾€å¾€éœ€è¦ä¸€äº›å®šåˆ¶åŒ–çš„è¡¡é‡èƒ½åŠ›ã€‚æ­£å¦‚Â [ArtificialÂ AnalysisÂ IntelligenceÂ Index](https://artificialanalysis.ai/methodology/intelligence-benchmarking)Â èšç„¦äºæ¨¡å‹é€šç”¨æ™ºåŠ›ï¼Œè€ŒÂ [ValsÂ Index](https://www.vals.ai/benchmarks/vals_index)Â èšç„¦äºæ¨¡å‹å•†ä¸šä»·å€¼ä¸€æ ·ï¼Œ**ä½ ä¹Ÿéœ€è¦ä¸€æŠŠå±äºè‡ªå·±çš„å°ºå­**ã€‚

æ„å»ºä¸€ä¸ª**è‡ªå®šä¹‰è¯„æµ‹æŒ‡æ•°ï¼ˆEvaluationÂ Indexï¼‰**çš„ä»·å€¼åœ¨äºï¼š

1.  **ä¸šåŠ¡å¯¹é½**ï¼šå°†çŸ¥è¯†æ°´å¹³ã€é•¿æ–‡æœ¬ã€æŒ‡ä»¤éµå¾ªç­‰ç­‰èƒ½åŠ›æŒ‰å®é™…ä¸šåŠ¡å æ¯”åŠ æƒï¼Œåˆ†æ•°ç›´æ¥åæ˜ â€œä¸šåŠ¡å¯ç”¨æ€§â€ã€‚
    
2.  **ä¸€æ¬¡è·‘æµ‹**ï¼šä¸éœ€è¦åˆ†åˆ«è·‘åå‡ ä¸ªæ•°æ®é›†å†æ‰‹åŠ¨ç®—åˆ†ï¼Œä¸€æ¬¡è¿è¡Œå³å¯å¾—åˆ°ç»¼åˆå¾—åˆ†ã€‚
    
3.  **ç»Ÿä¸€æ ‡å‡†**ï¼šä¸ºå›¢é˜Ÿå†…éƒ¨çš„æ¨¡å‹è¿­ä»£æä¾›ä¸€ä¸ªé•¿æœŸã€ç¨³å®šçš„â€œåŒ—ææ˜ŸæŒ‡æ ‡â€ã€‚
    

EvalScopeÂ çš„Â **Collection**Â æ¨¡å—æ­£æ˜¯ä¸ºæ­¤è®¾è®¡ï¼šå®ƒå…è®¸ä½ å®šä¹‰ä¸€ä»½**Schema**ï¼ˆèƒ½åŠ›åœ°å›¾ï¼‰ï¼ŒæŒ‰æƒé‡ç»„åˆå¤šä¸ªæ•°æ®é›†ï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªå¯ç›´æ¥ç”¨äºè¯„æµ‹çš„**æ··åˆæ•°æ®é›†**ã€‚

## 2.Â æ ¸å¿ƒæ€è·¯ï¼šä»Â SchemaÂ åˆ°Â Index

æ„å»ºæŒ‡æ•°çš„è¿‡ç¨‹éå¸¸ç¬¦åˆç›´è§‰ï¼Œåˆ†ä¸ºä¸‰æ­¥èµ°ï¼š

1.  **å®šä¹‰Â Schema**ï¼šé…ç½®â€œæˆ‘å…³å¿ƒå“ªäº›æ•°æ®é›†â€ä»¥åŠâ€œå®ƒä»¬å„å å¤šå°‘æƒé‡â€ã€‚
    
2.  **é‡‡æ ·Â (Sample)**ï¼šæ ¹æ®æƒé‡ï¼Œä»æµ·é‡æ•°æ®ä¸­æŠ½å–å‡ºä¸€ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„â€œæ··åˆæµ‹è¯•é›†â€ã€‚
    
3.  **è¯„æµ‹Â (Eval)**ï¼šåƒè¯„æµ‹æ™®é€šæ•°æ®é›†ä¸€æ ·ï¼Œå¯¹è¿™ä¸ªæ··åˆé›†è¿›è¡Œæ‰“åˆ†ï¼Œè·å¾—Â IndexÂ æ€»åˆ†åŠåˆ†é¡¹å¾—åˆ†ã€‚
    

ä¸‹é¢æˆ‘ä»¬ä»¥æ„å»ºä¸€ä¸ªÂ **â€œä¼ä¸šçº§Â RAGÂ åŠ©æ‰‹æŒ‡æ•°â€**Â ä¸ºä¾‹ï¼Œå¸¦ä½ ä»é›¶ä¸Šæ‰‹ã€‚

åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦å®‰è£…EvalScopeåº“ï¼Œè¿è¡Œä¸‹é¢çš„ä»£ç ï¼š

```shell
pip install 'evalscope[app]' -U
```

## 3.Â å®æˆ˜ï¼šæ„å»ºâ€œä¼ä¸šçº§Â RAGÂ åŠ©æ‰‹æŒ‡æ•°â€

å‡è®¾ä½ çš„ä¸šåŠ¡æ˜¯ä¸€ä¸ªä¼ä¸šçŸ¥è¯†åº“åŠ©æ‰‹ï¼Œä½ æœ€å…³å¿ƒçš„èƒ½åŠ›ç»´åº¦å¦‚ä¸‹ï¼š

*   **æ¨¡å‹çš„çŸ¥è¯†å’Œå¹»è§‰æ°´å¹³**ï¼ˆæ ¸å¿ƒèƒ½åŠ›ï¼Œæƒé‡Â 30%ï¼‰
    
*   **é•¿æ–‡æ¡£æ£€ç´¢ä¸ç†è§£**ï¼ˆæ ¸å¿ƒèƒ½åŠ›ï¼Œæƒé‡Â 30%ï¼‰
    
*   **ä¸¥æ ¼éµå¾ªæ ¼å¼æŒ‡ä»¤**ï¼ˆäº¤äº’ä½“éªŒï¼Œæƒé‡Â 40%ï¼‰
    

### ç¬¬ä¸€æ­¥ï¼šå®šä¹‰Â Schema

ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªÂ `CollectionSchema`ï¼Œåœ¨å…¶ä¸­åˆ—å‡ºé€‰ç”¨çš„æ•°æ®é›†åŠå…¶æƒé‡ã€‚

```python
from evalscope.collections import CollectionSchema, DatasetInfo

# å®šä¹‰ RAG ä¸šåŠ¡æŒ‡æ•°çš„ Schema
rag_schema = CollectionSchema(
    name='rag_assist_index', # æŒ‡æ•°åç§°
    datasets=[
        # 1. çŸ¥è¯†é—®ç­”èƒ½åŠ›ï¼Œå¹»è§‰ (30%)
        DatasetInfo(
            name='chinese_simpleqa', 
            weight=0.3, 
            task_type='knowledge', 
            tags=['rag', 'zh']
        ),
        
        # 2. é•¿æ–‡æœ¬æ£€ç´¢èƒ½åŠ› (30%)
        DatasetInfo(
            name='aa_lcr', 
            weight=0.3, 
            task_type='long_context', 
            tags=['rag', 'en']
        ),
        
        # 3. æŒ‡ä»¤éµå¾ªèƒ½åŠ› (40%)
        # args å‡ç”¨äºä¼ é€’ç»™åº•å±‚æ•°æ®é›†åŠ è½½å™¨ï¼Œå¦‚ subset_list æŒ‡å®šå­é›†
        DatasetInfo(
            name='ifeval', 
            weight=0.4, 
            task_type='instruction', 
            tags=['rag', 'en'],
        ),
    ]
)

# æ‰“å°æŸ¥çœ‹å½’ä¸€åŒ–åçš„æƒé‡åˆ†å¸ƒ
print(rag_schema.flatten())

```
> **ğŸ’¡Â æç¤º**ï¼š`weight`Â å¯ä»¥æ˜¯ä»»æ„æ­£æ•°ï¼ŒEvalScopeÂ ä¼šè‡ªåŠ¨è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚é€šè¿‡Â `flatten()`Â æ–¹æ³•å¯ä»¥é¢„è§ˆæœ€ç»ˆæ¯ä¸ªæ•°æ®é›†çš„å®é™…å æ¯”ã€‚

### ç¬¬äºŒæ­¥ï¼šé‡‡æ ·æ•°æ®

å®šä¹‰å¥½Â SchemaÂ åï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§ç­–ç•¥æŠ½å–æ ·æœ¬ã€‚EvalScopeÂ æä¾›äº†å¤šç§é‡‡æ ·å™¨ï¼Œé’ˆå¯¹â€œæ„å»ºæŒ‡æ•°â€åœºæ™¯ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨Â **åŠ æƒé‡‡æ ·Â (WeightedSampler)**ã€‚

*   **åŠ æƒé‡‡æ ·**ï¼šæ ·æœ¬æ•°é‡ä¸ä½ è®¾ç½®çš„æƒé‡æˆæ­£æ¯”ã€‚æƒé‡è¶Šé«˜çš„ä»»åŠ¡ï¼Œåœ¨æµ‹è¯•é›†ä¸­å‡ºç°çš„é¢˜ç›®è¶Šå¤šï¼Œå¯¹æ€»åˆ†çš„å½±å“ä¹Ÿè¶Šå¤§ã€‚è¿™æœ€èƒ½ä½“ç°â€œä¸šåŠ¡å¯¼å‘â€ã€‚
    

```python
from evalscope.collections import WeightedSampler
from evalscope.utils.io_utils import dump_jsonl_data

# åˆå§‹åŒ–åŠ æƒé‡‡æ ·å™¨
sampler = WeightedSampler(rag_schema)

# é‡‡æ · 100 æ¡æ•°æ®ä½œä¸ºæœ€ç»ˆæµ‹è¯•é›†
# æ ¹æ®æƒé‡ï¼ŒçŸ¥è¯†é—®ç­” 30 æ¡ï¼Œé•¿æ–‡æœ¬æ£€ç´¢ 30 æ¡ï¼ŒæŒ‡ä»¤éµå¾ª 40 æ¡
# å®é™…é‡‡æ ·æ•°é‡å¯æ ¹æ®éœ€è¦è°ƒæ•´
mixed_data = sampler.sample(count=100)

# å°†æ··åˆå¥½çš„æ•°æ®ä¿å­˜ä¸º JSONL æ–‡ä»¶ï¼Œè¿™å°±æ˜¯ä½ çš„â€œæŒ‡æ•°è¯„æµ‹é›†â€
dump_jsonl_data(mixed_data, 'outputs/rag_index_testset.jsonl')
```

é™¤äº†åŠ æƒé‡‡æ ·ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©ï¼š

*   `StratifiedSampler`ï¼ˆåˆ†å±‚é‡‡æ ·ï¼‰ï¼šä¿æŒåŸæ•°æ®é›†çš„æ ·æœ¬è§„æ¨¡æ¯”ä¾‹ï¼ˆé€‚åˆä¸åšäººä¸ºå¹²é¢„çš„å®¢è§‚ç»Ÿè®¡ï¼‰ã€‚
    
*   `UniformSampler`ï¼ˆå‡åŒ€é‡‡æ ·ï¼‰ï¼šæ‰€æœ‰æ•°æ®é›†æ ·æœ¬æ•°ç›¸åŒï¼ˆé€‚åˆæ¨ªå‘å¯¹æ¯”å„èƒ½åŠ›çŸ­æ¿ï¼‰ã€‚
    

### ç¬¬ä¸‰æ­¥ï¼šç»Ÿä¸€è¯„æµ‹

ç°åœ¨ï¼Œä½ æ‹¥æœ‰äº†ä¸€ä¸ªåä¸ºÂ `rag_index_testset.jsonl`Â çš„æ–‡ä»¶ã€‚åœ¨Â EvalScopeÂ çœ‹æ¥ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æœ¬åœ°æ•°æ®é›†ã€‚æˆ‘ä»¬ç›´æ¥è°ƒç”¨Â `run_task`Â å³å¯ã€‚

```python
import os
from evalscope import TaskConfig, run_task

task_cfg = TaskConfig(
    model='qwen2.5-14b-instruct', # è¯„æµ‹æ¨¡å‹
    # ä½¿ç”¨ä¸€ä¸ªæä¾› OpenAI å…¼å®¹æ¥å£çš„æ¨¡å‹è¿›è¡Œè¯„æµ‹
    # å¯ä»¥æ˜¯äº‘ä¸Šçš„APIï¼Œä¹Ÿå¯ä»¥æ˜¯é€šè¿‡vllmç­‰æ¡†æ¶éƒ¨ç½²çš„æœ¬åœ°æ¨¡å‹
    api_url='https://dashscope.aliyuncs.com/compatible-mode/v1',
    api_key=os.getenv('DASHSCOPE_API_KEY'),
    eval_type='openai_api',
    
    # å…³é”®é…ç½®ï¼šæŒ‡å®šæ•°æ®é›†ä¸º 'data_collection' æ¨¡å¼
    datasets=['data_collection'],
    dataset_args={
        'data_collection': {
            'local_path': 'outputs/rag_index_testset.jsonl', # æŒ‡å‘åˆšæ‰ç”Ÿæˆçš„æ–‡ä»¶
            'shuffle': True # æ‰“ä¹±é¡ºåº
        }
    },
    eval_batch_size=5, # æ ¹æ®ä½ çš„ API å¹¶å‘é™é¢è°ƒæ•´
    generation_config={
        'temperature': 0.0 # è¯„æµ‹é€šå¸¸è®¾ä¸º 0 ä»¥ä¿è¯ç»“æœå¯å¤ç°
    },
    # ä½¿ç”¨å¼ºå¤§çš„æ¨¡å‹ä½œä¸º judge è¿›è¡Œè‡ªåŠ¨è¯„åˆ† (chinese_simpleqa éœ€è¦)
    judge_model_args={
        'model_id': 'qwen3-max',
        'api_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1',
        'api_key': os.getenv('DASHSCOPE_API_KEY'),
    },
    judge_worker_num=5, # judge å¹¶å‘æ•°ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
)

run_task(task_cfg=task_cfg)
```

**çœ‹æ‡‚è¯„æµ‹æŠ¥å‘Šï¼š**

è¯„æµ‹å®Œæˆåï¼Œä½ ä¼šåœ¨æ—¥å¿—ä¸­çœ‹åˆ°Â `category_levelÂ Report`ã€‚å…¶ä¸­çš„Â `**weighted_avg**`Â å°±æ˜¯ä½ æœ€å…³å¿ƒçš„**IndexÂ æ€»åˆ†**ã€‚

```text
2025-12-23 18:01:45 - evalscope - INFO: task_level Report:
+--------------+------------+------------+---------------+-------+
|  task_type   | micro_avg. | macro_avg. | weighted_avg. | count |
+--------------+------------+------------+---------------+-------+
| instruction  |   0.9231   |   0.9231   |    0.9231     |  39   |
| long_context |   0.1333   |   0.1333   |    0.1333     |  30   |
|  knowledge   |   0.3793   |   0.3833   |    0.3793     |  29   |
+--------------+------------+------------+---------------+-------+
2025-12-23 18:01:45 - evalscope - INFO: tag_level Report:
+------+------------+------------+---------------+-------+
| tags | micro_avg. | macro_avg. | weighted_avg. | count |
+------+------------+------------+---------------+-------+
| rag  |   0.5204   |   0.4114   |    0.5204     |  98   |
|  en  |   0.5797   |   0.5797   |    0.5797     |  69   |
|  zh  |   0.3793   |   0.3833   |    0.3793     |  29   |
+------+------------+------------+---------------+-------+
2025-12-23 18:01:45 - evalscope - INFO: category_level Report:
+------------------+------------+------------+---------------+-------+
|    category0     | micro_avg. | macro_avg. | weighted_avg. | count |
+------------------+------------+------------+---------------+-------+
| rag_assist_index |   0.5204   |   0.4114   |    0.5204     |  98   |
+------------------+------------+------------+---------------+-------+

```

*   `weighted_avg`:Â åŸºäºä½ å®šä¹‰çš„Â SchemaÂ æƒé‡è®¡ç®—çš„å¾—åˆ†ã€‚å¦‚æœè¿™ä¸ªåˆ†æ•°é«˜ï¼Œè¯´æ˜æ¨¡å‹éå¸¸å¥‘åˆæˆ‘ä»¬ä¹‹å‰è‡ªå®šä¹‰çš„â€œä¸šåŠ¡ä»·å€¼è§‚â€ã€‚
    

### ç¬¬å››æ­¥ï¼šCaseåˆ†æ

æ‹¿åˆ°Â IndexÂ æ€»åˆ†å¹¶ä¸ä»£è¡¨å·¥ä½œç»“æŸã€‚ç›¸åï¼Œåˆ†ææ¨¡å‹ä¸ºä»€ä¹ˆå–å¾—è¿™ä¸ªåˆ†æ•°é€šå¸¸æ›´æœ‰ä»·å€¼ï¼šæ˜¯æ¨¡å‹çŸ¥è¯†å‚¨å¤‡ä¸è¶³ï¼Ÿè¿˜æ˜¯ä»…ä»…å› ä¸ºæ²¡æŒ‰æ ¼å¼è¾“å‡ºè¢«è¯¯åˆ¤ï¼Ÿ

EvalScopeÂ å†…ç½®äº†å¯è§†åŒ–åˆ†æå·¥å…·ï¼Œè®©ä½ éå¸¸æ–¹ä¾¿æŸ¥çœ‹æ¯ä¸€ä¸ªæ ·æœ¬çš„è¯¦ç»†æƒ…å†µã€‚æ— éœ€ç¼–å†™é¢å¤–ä»£ç ï¼Œåªéœ€åœ¨ç»ˆç«¯è¿è¡Œä¸€æ¡å‘½ä»¤ï¼Œå³å¯å¯åŠ¨æœ¬åœ°æœåŠ¡ï¼š

```shell
evalscope app
```

æ‰“å¼€æµè§ˆå™¨è®¿é—®Â `http://127.0.0.1:7860`å³å¯æŸ¥çœ‹æ¨¡å‹å¾—åˆ†åˆ†å¸ƒå’Œåœ¨æ¯ä¸ªé—®é¢˜çš„å›å¤å’Œæ‰“åˆ†ï¼š

![image.png](https://sail-moe.oss-cn-hangzhou.aliyuncs.com/yunlin/images/evalscope/doc/best_practice/overview.jpg)

![image.png](https://sail-moe.oss-cn-hangzhou.aliyuncs.com/yunlin/images/evalscope/doc/best_practice/single.jpg)

## 4.Â æ›´å¤šåœºæ™¯æ¡ˆä¾‹

EvalScopeÂ çš„Â IndexÂ æ„å»ºèƒ½åŠ›éå¸¸çµæ´»ï¼Œé™¤äº†Â RAGï¼Œä½ è¿˜å¯ä»¥æ„å»ºå„ç§å‚ç›´é¢†åŸŸçš„æŒ‡æ•°ã€‚

### æ¡ˆä¾‹Â Aï¼šä»£ç è¡¥å…¨ä¸åˆ†ææŒ‡æ•°

å…³æ³¨Â PythonÂ ä»£ç ç”Ÿæˆèƒ½åŠ›ä»¥åŠçœŸå®çš„Â IssueÂ ä¿®å¤èƒ½åŠ›ï¼Œä¸”æ›´çœ‹é‡Â PythonÂ èƒ½åŠ›ã€‚

```python
schema = CollectionSchema(name='code_index', datasets=[
    # åŸºç¡€ Python ä»£ç ç”Ÿæˆï¼Œç»™äºˆè¾ƒé«˜çš„æƒé‡ï¼ˆ60%ï¼‰
    DatasetInfo(name='humaneval', weight=0.6, task_type='code', tags=['python']),
    
    # çœŸå®åœºæ™¯ä»£ç ç«èµ›é¢˜ï¼ŒåŒ…å«ç‰¹å®šæ—¶é—´æ®µçš„æ•°æ®ï¼Œ40% æƒé‡
    DatasetInfo(
        name='live_code_bench', 
        weight=0.4, 
        task_type='code', 
        tags=['complex'], 
        args={
            'subset_list': ['v5'], 
            'review_timeout': 6,
            'extra_params': {'start_date': '2024-08-01', 'end_date': '2025-02-28'}
        }
    ),
])

```

### æ¡ˆä¾‹Â Bï¼šæ¨¡å‹æ¨ç†èƒ½åŠ›æŒ‡æ•°Â (ReasoningÂ Index)

æ··åˆå¤šç§æ¨ç†ä»»åŠ¡ï¼Œå¹¶é€šè¿‡åµŒå¥—ç»“æ„ç®¡ç†ä¸­è‹±æ–‡æ•°æ®é›†ã€‚

```python
# åµŒå¥—ç»“æ„ç¤ºä¾‹ï¼šæ•°å­¦ç»„ + æ¨ç†ç»„
schema = CollectionSchema(name='reasoning_index', datasets=[
    CollectionSchema(name='math', weight=0.5, datasets=[
        DatasetInfo(name='gsm8k', weight=0.5, tags=['en']),
        DatasetInfo(name='aime25', weight=0.5, tags=['en']),
    ]),
    CollectionSchema(name='logic', weight=0.5, datasets=[
        DatasetInfo(name='arc', weight=0.5, tags=['en']),
        DatasetInfo(name='ceval', weight=0.5, tags=['zh'], args={'subset_list': ['logic']}),
    ]),
])

```

## 5.Â è¿›é˜¶ï¼šåˆ†äº«ä½ çš„Â Index

æˆ‘ä»¬ç›¸ä¿¡ï¼Œæ¯ä¸€ä¸ªç»†åˆ†é¢†åŸŸï¼Œæ— è®ºæ˜¯åŒ»ç–—é—®ç­”ã€æ³•å¾‹æ–‡ä¹¦å®¡æ ¸ï¼Œè¿˜æ˜¯é‡‘èç ”æŠ¥åˆ†æï¼Œéƒ½éœ€è¦ä¸€æŠŠç²¾ç¡®çš„å°ºå­ã€‚è€Œæœ€æ‡‚è¿™æŠŠå°ºå­è¯¥æ€ä¹ˆåˆ»åº¦çš„ï¼Œæ­£æ˜¯æ·±è€•äºè¯¥é¢†åŸŸçš„ä½ ã€‚

å½“ä½ æ„å»ºå‡ºä¸€ä¸ªé«˜è´¨é‡çš„è¯„æµ‹æŒ‡æ•°æ—¶ï¼Œå®ƒä¸åº”è¯¥åªèººåœ¨ä½ çš„ç¡¬ç›˜é‡Œã€‚æˆ‘ä»¬å¼ºçƒˆé¼“åŠ±ä½ å°†ç”Ÿæˆçš„æ•°æ®é›†ä¸Šä¼ åˆ°Â ModelScopeÂ ç¤¾åŒºã€‚è¿™ä¸ä»…èƒ½è®©æ›´å¤šå¼€å‘è€…å—ç›Šï¼Œä¹Ÿèƒ½è®©ä½ çš„æ ‡å‡†æˆä¸ºè¡Œä¸šå…±è¯†ã€‚

### å¦‚ä½•ä¸Šä¼ åˆ°ModelScopeä»“åº“ï¼Ÿ

æ‰‹åŠ¨ä¸Šä¼ æ•°æ®é›†åˆ°ModelScopeçš„å…·ä½“æ–¹æ³•å¯[å‚è€ƒæ–‡æ¡£](https://modelscope.cn/docs/datasets/create)ï¼Œä½¿ç”¨modelscopeÂ SDKç›´æ¥æ‰§è¡Œå¦‚ä¸‹Pythonä»£ç ï¼š

```python
from modelscope.hub.api import HubApi

# ç™»é™†
YOUR_ACCESS_TOKEN = 'è¯·ä»https://modelscope.cn/my/myaccesstoken è·å–SDKä»¤ç‰Œ'
api = HubApi()
api.login(YOUR_ACCESS_TOKEN)

# é…ç½®æ•°æ®é›†å¹¶ä¸Šä¼ 
owner_name = 'user'
dataset_name = 'MyEvaulationIndex'

api.upload_file(
    path_or_fileobj='/path/to/local/your_index.jsonl',
    path_in_repo='your_index.jsonl',
    repo_id=f"{owner_name}/{dataset_name}",
    repo_type = 'dataset',
    commit_message='upload dataset file to repo',
)
```

æˆ–è€…ä½¿ç”¨modelscopeÂ CLIï¼š

```shell
# ç™»é™†
modelscope login --token YOUR_ACCESS_TOKEN

# ä¸Šä¼ æ–‡ä»¶
modelscope upload owner_name/dataset_name /path/to/local/your_index.jsonl your_index.jsonl --repo-type dataset
```

è¿™æ ·ä½ çš„æ•°æ®é›†å°±æ‰˜ç®¡åœ¨ModelScopeå¹³å°ä¸Šäº†ã€‚

### å¦‚ä½•ä½¿ç”¨ç¤¾åŒºå…±äº«çš„Â Indexï¼Ÿ

ä¾‹å¦‚ï¼Œç¤¾åŒºå·²ç»è´¡çŒ®äº†Â [æ¨¡å‹æ¨ç†èƒ½åŠ›æµ‹è¯•é›†](https://modelscope.cn/datasets/evalscope/R1-Distill-Math-Evaluation-Index)ï¼Œå…¶æ•°æ®é›†IDä¸º`evalscope/R1-Distill-Math-Evaluation-Index`ã€‚ä½ æ— éœ€è‡ªå·±åœ¨æœ¬åœ°é‡‡æ ·ï¼Œç›´æ¥å¼•ç”¨Â DatasetÂ IdÂ å³å¯å¼€å§‹è¯„æµ‹ï¼š

```python
from evalscope import TaskConfig, run_task
import os

task_cfg = TaskConfig(
    model='qwen-plus',
    api_url='https://dashscope.aliyuncs.com/compatible-mode/v1',
    api_key=os.getenv('DASHSCOPE_API_KEY'),
    
    # ç›´æ¥åŠ è½½ç¤¾åŒºä¸Šçš„ Index æ•°æ®é›†
    datasets=['data_collection'],
    dataset_args={
        'data_collection': {
            'dataset_id': 'evalscope/R1-Distill-Math-Evaluation-Index', # ç¤¾åŒºæ•°æ®é›† ID
        }
    }
)

run_task(task_cfg=task_cfg)
```

## æ€»ç»“

æ„å»ºè¯„æµ‹æŒ‡æ•°ä¸å†æ˜¯å¤§å‚æˆ–å­¦æœ¯ç•Œçš„ä¸“åˆ©ã€‚é€šè¿‡Â EvalScopeÂ çš„Â CollectionÂ æœºåˆ¶ï¼š

1.  ç”¨Â SchemaÂ å®šä¹‰äº†ä¸šåŠ¡çš„ä»·å€¼è§‚
    
2.  ç”¨Â SamplerÂ å°†ä»·å€¼è§‚å…·è±¡åŒ–ä¸ºæµ‹è¯•æ•°æ®
    
3.  ç”¨Â EvalÂ è·å¾—äº†ä¸€ä¸ªå¯ä¿¡çš„å†³ç­–ä¾æ®
    
4.  ç”¨Â CaseÂ åˆ†æå®šä½äº†æ¨¡å‹çš„å¼±ç‚¹
    

ä¸è¦å†å±€é™äºé€šç”¨æ¦œå•çš„åˆ†æ•°ï¼Œç°åœ¨å°±å¼€å§‹æ„å»ºå±äºä½ è‡ªå·±çš„Â **Index**ï¼Œé€‰å‡ºçœŸæ­£é€‚åˆä½ ä¸šåŠ¡çš„â€œæœ€ä½³æ¨¡å‹â€å§ï¼